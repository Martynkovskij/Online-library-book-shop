@startuml BookShop Activity Diagram

|Пользователь|
start

:Вход на сайт;

if (Пользователь авторизован?) then (да)
  :Просмотр каталога книг;
else (нет)
  :Регистрация/Авторизация;
  :Просмотр каталога книг;
endif

:Выбор книг;
:Добавление в корзину;

if (Корзина пуста?) then (да)
  :Возврат к каталогу;
  -[#red]-> Просмотр каталога книг;
else (нет)
  :Переход к оформлению заказа;
endif

|Система|
:Заполнение данных доставки;
:Выбор способа оплаты;

if (Оплата картой?) then (да)
  :Ввод данных карты;
  :Проверка данных;
  if (Данные корректны?) then (да)
    :Обработка платежа;
  else (нет)
    :Ошибка ввода;
    -[#red]-> Ввод данных карты;
  endif
else (нет)
  :Оплата при получении;
endif

:Подтверждение заказа;
:Отправка уведомления;
:Обновление базы данных;

stop

@enduml 